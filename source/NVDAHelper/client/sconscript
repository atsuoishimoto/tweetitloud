Import([
	'env',
])

controllerRPCHeader,controllerRPCClientSource,controllerRPCServerSource=env.MSRPCStubs(
	target="./nvdaController",
	source=[
		"#interfaces/nvdaController/nvdaController.idl",
		"#interfaces/nvdaController/nvdaController.acf",
	],
	MIDLFLAGS=env['MIDLFLAGS']+['/prefix','all','nvdaController_'],
)

clientLibName="nvdaControllerClient%s"%('64' if env['TARGET_ARCH']=='x86_64' else '32')

clientLib=env.SharedLibrary(
	target=clientLibName,
	source=[
		"client.c",
		controllerRPCClientSource,
		'nvdaControllerClient.def',
	],
	LIBS=[
		"rpcrt4",
	],
)

#if 'install' in COMMAND_LINE_TARGETS:
#	installDir=env.Install('#../../extras/controllerClient/',clientLib)
#	env.Default(installDir)

#env.Default(clientLib)

Return(['clientLib','controllerRPCHeader'])
